oddsratio(BRAFexp.stage)
s1 <- survdiff(Surv(fw_days, death) ~ stage)
p_value1 <- round(1 - pchisq(s1$chisq, length(s1$n) - 1), 3)
p_value1
s1.fit <- survfit(Surv(fw_days, death) ~ stage, type="kaplan-meier")
plot(s1.fit, main=paste("Stage","(p=",p_value1,")", sep=""), xlab="Follow up days",
col=col, lty=2:3)
legend("bottomright", lty=1, legend = c("I", "II", "III", "IV"), col=col)
s1
p_value1 <- (1 - pchisq(s1$chisq, length(s1$n) - 1)
p_value1 <- (1 - pchisq(s1$chisq, length(s1$n) - 1))
p_value1
p_value1 <- (1 - pchisq(s1$chisq, length(s1$n) - 1))
p_value1
s1.fit <- survfit(Surv(fw_days, death) ~ stage, type="kaplan-meier")
plot(s1.fit, main=paste("Stage","(p=",p_value1,")", sep=""), xlab="Follow up days",
col=col, lty=2:3)
plot(s1.fit, main=paste("Stage","(p=1.46e-09)", sep=""), xlab="Follow up days",
col=col, lty=2:3)
legend("bottomright", lty=1, legend = c("I", "II", "III", "IV"), col=col)
s2 <- survdiff(Surv(fw_days, death) ~ GLUT1)
p_value3 <- round(1 - pchisq(s3$chisq, length(s3$n) - 1), 3)
p_value3
s2 <- survdiff(Surv(fw_days, death) ~ GLUT1)
p_value2 <- round(1 - pchisq(s2$chisq, length(s2$n) - 1), 3)
p_value2
s2.fit <- survfit(Surv(fw_days, death) ~ GLUT1, type="kaplan-meier")
plot(s2.fit, main=paste("GLUT1","(p=",p_value2,")", sep=""), xlab="Follow up days",
col=col, lty=2:3)
s2
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col))
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col)
s3 <- survdiff(Surv(fw_days, death) ~ GLUT3)
p_value3 <- round(1 - pchisq(s3$chisq, length(s3$n) - 1), 3)
p_value3
s3.fit <- survfit(Surv(fw_days, death) ~ GLUT3, type="kaplan-meier")
plot(s3.fit, main=paste("GLUT3","(p=",p_value3,")", sep=""), xlab="Follow up days",
col=col, lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col)
plot(s1.fit, main=paste("Stage","(p=1.46e-09)", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
plot(s1.fit, main=paste("Stage","(p=1.46e-09)", sep=""), xlab="Follow up days",
col=col, lty=2:3)
legend("bottomright", lty=1, legend = c("I", "II", "III", "IV"), col=col)
plot(s2.fit, main=paste("GLUT1","(p=",p_value2,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col[2:1])
plot(s3.fit, main=paste("GLUT3","(p=",p_value3,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col[2:1])
s4 <- survdiff(Surv(fw_days, death) ~ HIF1)
p_value4 <- round(1 - pchisq(s4$chisq, length(s5$n) - 1), 3)
s4 <- survdiff(Surv(fw_days, death) ~ HIF1)
p_value4 <- round(1 - pchisq(s4$chisq, length(s4$n) - 1), 3)
s4.fit <- survfit(Surv(fw_days, death) ~ HIF1, type="kaplan-meier")
plot(s5.fit, main=paste("HIF1A","(p=",p_value4,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
plot(s4.fit, main=paste("HIF1A","(p=",p_value4,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col[2:1])
s5 <- survdiff(Surv(fw_days, death) ~ HIF2)
p_value5 <- round(1 - pchisq(s5$chisq, length(s5$n) - 1), 3)
s5.fit <- survfit(Surv(fw_days, death) ~ HIF2, type="kaplan-meier")
plot(s5.fit, main=paste("HIF1A","(p=",p_value4,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
plot(s5.fit, main=paste("HIF1A","(p=",p_value5,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col[2:1])
s6 <- survdiff(Surv(fw_days, death) ~ BRAF_V600E)
s6 <- survdiff(Surv(fw_days, death) ~ glut.table$BRAF_V600E)
p_value6 <- round(1 - pchisq(s6$chisq, length(s6$n) - 1), 3)
s6.fit <- survfit(Surv(fw_days, death) ~ glut.table$BRAF_V600E, type="kaplan-meier")
plot(s6.fit, main=paste("BRAF V600E","(p=",p_value6,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression "), col=col[2:1])
s6
legend("bottomright", lty=1, legend = c("Wild", "Mutant"), col=col[2:1])
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1)
summary(ls1)
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col[2:1], lty=2:3)
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1))
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1 + SLC2A3)
summary(ls1)
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
plot(survfit(ls1), main="GLUT1 + GLUT3, p-value=0.041", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1))
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1 * SLC2A3)
summary(ls1)
plot(survfit(ls1), main="GLUT1 + GLUT3, p-value=0.041", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1))
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1)
summary(ls1)
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1, main="GLUT1, p-value=0.132"))
ggsurv(survfit(ls1), main="GLUT1, p-value=0.132", col=col)
ggsurv(survfit(ls1), main="GLUT1, p-value=0.132")
ls2 <- coxph(Surv(fw_days, death) ~ SLC2A3)
summary(ls2)
plot(survfit(ls1), main="GLUT1, p-value=0.012", xlab="Follow up days", col=col, lty=2:3)
plot(survfit(ls1), main="GLUT3, p-value=0.012", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1), main="GLUT3, p-value=0.012")
ggsurv(survfit(ls1), main="GLUT1, p-value=0.132")
ggsurv(survfit(ls1), main="GLUT3, p-value=0.012")
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
plot(survfit(ls1), main="GLUT3, p-value=0.012", xlab="Follow up days", col=col, lty=2:3)
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1)
summary(ls1)
plot(ls1, main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
ls1.fit <- survfit(coxph(Surv(fw_days, death) ~ SLC2A1), type="kaplan-meier")
plot(ls1fit, main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
plot(ls1.fit, main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1), main="GLUT1, p-value=0.132")
SLC2A1
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1)
summary(ls1)
ls1
plot(survfit(ls1))
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls1), main="GLUT1, p-value=0.132")
ls2 <- coxph(Surv(fw_days, death) ~ SLC2A3)
summary(ls2)
plot(survfit(ls2), main="GLUT3, p-value=0.012", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls2), main="GLUT3, p-value=0.012")
survfit(ls1)
survfit(ls2)
survfit (ls1) = survfit(ls2)
survfit (ls1) == survfit(ls2)
ggsurv(survfit(ls1), main="GLUT1, p-value=0.132")
ggsurv(survfit(ls2), main="GLUT3, p-value=0.012")
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
plot(survfit(ls2), main="GLUT3, p-value=0.012", xlab="Follow up days", col=col, lty=2:3)
ls3 <- coxph(Surv(fw_days, death) ~ SLC2A1 + SLC2A3)
summary(ls3)
plot(survfit(ls3), main="GLUT3, p-value=0.043", xlab="Follow up days", col=col, lty=2:3)
plot(survfit(ls3), main="GLUT1 + GLUT3, p-value=0.043", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls3), main="GLUT1 + GLUT3, p-value=0.043")
ls3 <- coxph(Surv(fw_days, death) ~ HIF1A)
summary(ls3)
plot(survfit(ls3), main="HIF1A, p-value=0.198", xlab="Follow up days", col=col, lty=2:3)
ggsurv(survfit(ls3), main="HIF1A, p-value=0.198")
ls4 <- coxph(Surv(fw_days, death) ~ HIF2A)
summary(ls4)
plot(survfit(ls4), main="HIF2A, p-value=0.688", xlab="Follow up days", col=col, lty=2:3)
ls5 <- coxph(Surv(fw_days, death) ~ glut.table$BRAF)
summary(ls5)
ls6 <- coxph(Surv(fw_days, death) ~ stage)
summary(ls6)
plot(survfit(ls6), main="Stage, p-value=0.0001505", xlab="Follow up days", col=col, lty=2:3)
singlelm <- read.table("D://07 Research/008 Glucose Metabolism/20140808/singlelm.txt",
header=T, sep="\t", row.names=1, colClasses=c("factor",rep("numeric",13)))
multilm <- read.table("D://07 Research/008 Glucose Metabolism/20140808/multilm.txt",
header=T, sep="\t", row.names=1, colClasses=c("factor",rep("numeric",13)))
str(singlelm)
str(multilm)
s <- as.matrix(singlelm)
m <- as.matrix(multilm)
library(RColorBrewer)
library(gplots)
hmcol <- colorRampPalette(brewer.pal(9, "GnBu"))(100)
heatmap(s, cexCol=0.7, col=hmcol, main="Univariate Linear Regression Results")
heatmap(m, cexCol=0.7, col=hmcol, main="Multivariate Linear Regression Results")
heatmap.2(s, trace="none", cexCol=0.9, col=hmcol, main="Univariate Linear Regression Results")
heatmap.2(m, trace="none", cexCol=0.9, col=hmcol, main="Multivariate Linear Regression Results")
GLUT1.surv <- table(glut.table$death, glut.table$GLUT1)
oddsratio(GLUT1.surv)
oddsratio(table1.GLUT1)
oddsratio(table2.GLUT1)
t1 <- table(glut.table$stage, glut.table$GLUT1)
t2 <- table(glut.table$stage, glut.table$GLUT3)
t3 <- table(glut.table$stage, glut.table$HIF1)
t4 <- table(glut.table$stage, glut.table$HIF2)
t5 <- table(glut.table$stage, glut.table$BRAF_V600E)
oddsratio(t1)
oddsratio(t2)
oddsratio(t3)
oddsratio(t4)
oddsratio(table1.GLUT3)
table1.GLUT1 <- table(glut.table$death, glut.table$GLUT1)
table2.GLUT1 <- table(glut.table$recurr, glut.table$GLUT1)
table1.GLUT3 <- table(glut.table$death, glut.table$GLUT3)
table2.GLUT3 <- table(glut.table$recurr, glut.table$GLUT3)
table1.HIF1A <- table(glut.table$death, glut.table$HIF1)
table2.HIF1A <- table(glut.table$recurr, glut.table$HIF1)
table1.HIF2A <- table(glut.table$death, glut.table$HIF2)
table2.HIF2A <- table(glut.table$recurr, glut.table$HIF2)
table1.BRAF <- table(glut.table$death, glut.table$BRAF_V600E)
table2.BRAF <- table(glut.table$recurr, glut.table$BRAF_V600E)
table1.Stage <- table(glut.table$death, glut.table$stage.simple)
table2.Stage <- table(glut.table$recurr, glut.table$stage.simple)
oddsratio(table1.GLUT1)
oddsratio(table2.GLUT1)
oddsratio(table1.GLUT3)
oddsratio(table2.GLUT3)
oddsratio(table1.HIF1A)
oddsratio(table2.HIF1A)
oddsratio(table1.HIF2A)
oddsratio(table2.HIF2A)
oddsratio(table1.BRAF)
oddsratio(table2.BRAF)
t5 <- table(glut.table$stage, glut.table$BRAF_V600E)
oddsratio(t5)
dat <- read.delim("C://Work/GLUT/GLUT metatable.txt", sep='\t', header=TRUE, na.strings=c("NULL","[Not Applicable]","[Not Available]"))
dim(dat)
stage.simple <- as.numeric(dat$Stage)
stage.simple <- ifelse(stage.simple <= 2, 0,1)
stage.simple <- factor(stage.simple, levels = 0:1, labels = c("Early", "Advanced"))
str(stage.simple)
GLUT1 <- dat$SLC2A1
GLUT1 <- ifelse(GLUT1 < mean(GLUT1), 0, 1)
GLUT1 <- factor(GLUT1, levels = 0:1, labels = c("Low","High"))
summary(GLUT1)
GLUT3 <- dat$SLC2A3
GLUT3 <- ifelse(GLUT3 < mean(GLUT3), 0, 1)
GLUT3 <- factor(GLUT3, levels = 0:1, labels = c("Low","High"))
summary(GLUT3)
HIF1 <- dat$HIF1A
HIF1 <- ifelse(HIF1 < mean(HIF1), 0, 1)
HIF1 <- factor(HIF1, levels = 0:1, labels = c("Low","High"))
summary(HIF1)
HIF2 <- dat$EPAS1
HIF2 <- ifelse(HIF2 < mean(HIF2), 0, 1)
HIF2 <- factor(HIF2, levels = 0:1, labels = c("Low","High"))
summary(HIF1)
BRAF.exp <- dat$BRAF
BRAF.exp <- ifelse(BRAF.exp < mean(BRAF.exp), 0, 1)
BRAF.exp <- factor(BRAF.exp, levels = 0:1, labels = c("Low", "High"))
summary(BRAF.exp)
# Survival analysis prep.
death <- c(rep("FALSE", 486))
death <- dat$Vital_Status == "Dead"
summary(death)
recurr <- c(rep("FALSE", 486))
recurr <- dat$Recurrence == "YES"
summary(recurr)
fw_days <- dat$FW_Days
summary(fw_days)
fw_years <- round(fw_days/365.0, 2)
summary(fw_years)
# Create tidy table
barcode <- dat$ID
gender <- dat$Gender
race <- dat$Race
age <- dat$Age_Dx
hashimoto <- dat$Hashimoto
histol <- dat$Histologic_Dx
size <- dat$Max_Size
nodemeta <- dat$Metastatic_LN
ETE <- dat$ETE
stage <- dat$Stage
BRAF_mut <- dat$BRAF_V600E
SLC2A1 <- dat$SLC2A1
SLC2A3 <- dat$SLC2A3
HIF1A <- dat$HIF1A
HIF2A <- dat$EPAS1
BRAF <- dat$BRAF
glut.table <- data.frame(barcode = barcode, gender = gender, race = race, age = age,
hashimoto=hashimoto, histol = histol, size = size, nodemeta = nodemeta,
ETE = ETE, stage = stage, stage.simple = stage.simple, fw_days = fw_days,
fw_years = fw_years, death = death, recurr = recurr,
GLUT1 = GLUT1, GLUT3 = GLUT3, HIF1 = HIF1, HIF2 = HIF2,
BRAF_V600E = BRAF_mut, BRAF_Exp = BRAF.exp, SLC2A1 = SLC2A1, SLC2A3 = SLC2A3,
HIF1A = HIF1A, HIF2A = HIF2A, BRAF=BRAF)
# Start Analysis
library(RColorBrewer)
library(epiR)
library(epitools)
library(survival)
library(ggplot2)
library(GGally)
library(gmodels)
col = brewer.pal(9,"Set1")
# GLUT1
GLUT1.surv <- table(glut.table$death, glut.table$GLUT1)
oddsratio(GLUT1.surv)
CrossTable(GLUT1.surv, fisher=T, chisq=T, mcnemar=T, expected=T, sresid=T, format="SPSS")
GLUT1.recurr <- table(glut.table$recurr, glut.table$GLUT1)
oddsratio(GLUT1.recurr)
CrossTable(GLUT1.recurr, fisher=T, chisq=T, mcnemar=T, expected=T, sresid=T, format="SPSS")
GLUT1.stage <- table(glut.table$stage, glut.table$GLUT1)
oddsratio(GLUT1.stage)
# GLUT3
GLUT3.surv <- table(glut.table$death, glut.table$GLUT3)
oddsratio(GLUT3.surv)
CrossTable(GLUT3.surv, fisher=T, chisq=T, mcnemar=T, expected=T, sresid=T, format="SPSS")
GLUT3.recurr <- table(glut.table$recurr, glut.table$GLUT3)
oddsratio(GLUT3.recurr)
CrossTable(GLUT3.recurr, fisher=T, chisq=T, mcnemar=T, expected=T, sresid=T, format="SPSS")
GLUT3.stage <- table(glut.table$stage, glut.table$GLUT3)
oddsratio(GLUT3.stage)
CrossTable(GLUT3.stage, fisher=T, chisq=T, mcnemar=T, expected=T, sresid=T, format="SPSS")
# HIF1A
HIF1A.surv <- table(glut.table$death, glut.table$HIF1)
oddsratio(HIF1A.surv)
HIF1A.recurr <- table(glut.table$recurr, glut.table$HIF1)
oddsratio(HIF1A.recurr)
HIF1A.stage <- table(glut.table$stage, glut.table$HIF1)
oddsratio(HIF1A.stage)
# HIF2A
HIF2A.surv <- table(glut.table$death, glut.table$HIF2)
oddsratio(HIF2A.surv)
HIF2A.recurr <- table(glut.table$recurr, glut.table$HIF2)
oddsratio(HIF2A.recurr)
HIF2A.stage <- table(glut.table$stage, glut.table$HIF2)
oddsratio(HIF2A.stage)
# BRAF_V600E mutation
BRAFmut.surv <- table(glut.table$death, glut.table$BRAF_V600E)
oddsratio(BRAFmut.surv)
BRAFmut.recurr <- table(glut.table$recurr, glut.table$BRAF_V600E)
oddsratio(BRAFmut.recurr)
BRAFmut.stage <- table(glut.table$stage, glut.table$BRAF_V600E)
oddsratio(BRAFmut.stage)
# BRAF gene expression
BRAFexp.surv <- table(glut.table$death, glut.table$BRAF_Exp)
oddsratio(BRAFexp.surv)
BRAFexp.recurr <- table(glut.table$recurr, glut.table$BRAF_Exp)
oddsratio(BRAFexp.recurr)
BRAFexp.stage <- table(glut.table$stage, glut.table$BRAF_Exp)
oddsratio(BRAFexp.stage)
# Survival Analysis, binary
s1 <- survdiff(Surv(fw_days, death) ~ stage)
p_value1 <- (1 - pchisq(s1$chisq, length(s1$n) - 1))
p_value1
s1.fit <- survfit(Surv(fw_days, death) ~ stage, type="kaplan-meier")
plot(s1.fit, main=paste("Stage","(p=1.46e-09)", sep=""), xlab="Follow up days",
col=col, lty=2:3)
legend("bottomright", lty=1, legend = c("I", "II", "III", "IV"), col=col)
ggsurv(survfit(ls1), main="Stage, p=1.46e-09")
ggsurv(survfit(s1), main="Stage, p=1.46e-09")
ggsurv(s1.fit, main="Stage, p=1.46e-09")
s2 <- survdiff(Surv(fw_days, death) ~ GLUT1)
p_value2 <- round(1 - pchisq(s2$chisq, length(s2$n) - 1), 3)
p_value2
s2.fit <- survfit(Surv(fw_days, death) ~ GLUT1, type="kaplan-meier")
plot(s2.fit, main=paste("GLUT1","(p=",p_value2,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Lower Expression", "Higher Expression"), col=col[2:1])
plot(s2.fit, main=paste("GLUT1","(p=",p_value2,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Below the Mean", "Above the Mean"), col=col[2:1])
par(mfrow=c(2,2))
s2 <- survdiff(Surv(fw_days, death) ~ GLUT1)
p_value2 <- round(1 - pchisq(s2$chisq, length(s2$n) - 1), 3)
p_value2
s2.fit <- survfit(Surv(fw_days, death) ~ GLUT1, type="kaplan-meier")
plot(s2.fit, main=paste("GLUT1","(p=",p_value2,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Below the Mean", "Above the Mean"), col=col[2:1])
s3 <- survdiff(Surv(fw_days, death) ~ GLUT3)
p_value3 <- round(1 - pchisq(s3$chisq, length(s3$n) - 1), 3)
p_value3
s3.fit <- survfit(Surv(fw_days, death) ~ GLUT3, type="kaplan-meier")
plot(s3.fit, main=paste("GLUT3","(p=",p_value3,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Below the Mean", "Above the Mean"), col=col[2:1])
s4 <- survdiff(Surv(fw_days, death) ~ HIF1)
p_value4 <- round(1 - pchisq(s4$chisq, length(s4$n) - 1), 3)
s4.fit <- survfit(Surv(fw_days, death) ~ HIF1, type="kaplan-meier")
plot(s4.fit, main=paste("HIF1A","(p=",p_value4,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Below the Mean", "Above the Mean"), col=col[2:1])
s5 <- survdiff(Surv(fw_days, death) ~ HIF2)
p_value5 <- round(1 - pchisq(s5$chisq, length(s5$n) - 1), 3)
s5.fit <- survfit(Surv(fw_days, death) ~ HIF2, type="kaplan-meier")
plot(s5.fit, main=paste("HIF2A","(p=",p_value5,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Below the Mean", "Above the Mean"), col=col[2:1])
par(mfrow=c(2,1))
par(mfrow=c(1,1))
s6 <- survdiff(Surv(fw_days, death) ~ glut.table$BRAF_V600E)
p_value6 <- round(1 - pchisq(s6$chisq, length(s6$n) - 1), 3)
s6.fit <- survfit(Surv(fw_days, death) ~ glut.table$BRAF_V600E, type="kaplan-meier")
plot(s6.fit, main=paste("BRAF V600E","(p=",p_value6,")", sep=""), xlab="Follow up days",
col=col[2:1], lty=2:3)
legend("bottomright", lty=1, legend = c("Wild", "Mutant"), col=col[2:1])
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1)
summary(ls1)
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
par(mfrow=c(2,2))
ls1 <- coxph(Surv(fw_days, death) ~ SLC2A1)
summary(ls1)
plot(survfit(ls1), main="GLUT1, p-value=0.132", xlab="Follow up days", col=col, lty=2:3)
ls2 <- coxph(Surv(fw_days, death) ~ SLC2A3)
summary(ls2)
plot(survfit(ls2), main="GLUT3, p-value=0.012", xlab="Follow up days", col=col, lty=2:3)
ls12 <- coxph(Surv(fw_days, death) ~ SLC2A1 + SLC2A3)
ls3 <- coxph(Surv(fw_days, death) ~ HIF1A)
summary(ls3)
plot(survfit(ls3), main="HIF1A, p-value=0.198", xlab="Follow up days", col=col, lty=2:3)
ls4 <- coxph(Surv(fw_days, death) ~ HIF2A)
summary(ls4)
plot(survfit(ls4), main="HIF2A, p-value=0.688", xlab="Follow up days", col=col, lty=2:3)
ls5 <- coxph(Surv(fw_days, death) ~ glut.table$BRAF)
summary(ls5)
ls6 <- coxph(Surv(fw_days, death) ~ stage)
summary(ls6)
plot(survfit(ls6), main="Stage, p-value=0.0001505", xlab="Follow up days", col=col, lty=2:3)
ls5 <- coxph(Surv(fw_days, death) ~ glut.table$BRAF)
summary(ls5)
setwd("C://Work/Coursera")
source("corr.R")
source("complete.R")
cr <- corr("specdata", 150)
pollutantmean <- function(directory, pollutant, id=1:332){
if(grep("specdata", directory) == T){
directory <- ("./specdata/")
}
tm <- c()
all_files <- as.character(list.files(directory))
file_paths <- paste(directory, all_files, sep="")
for (i in id){
current_file <- read.csv(file_paths[i], header=T, sep=",")
head(current_file)
pollutant
na_removed <- current_file[!is.na (current_file[, pollutant]), pollutant]
tm <- c(tm, na_removed)
}
result <- mean(tm)
return(round(result,3))
}
pollutantmean("specdata", "sulfate", 1:10)
pollutantmean("specdata", "nitrate", 70:72)
pollutantmean("specdata", "nitrate", 23)
pollutantmean("specdata", "sulfate", 1:10)
pollutantmean <- function(directory, pollutant, id=1:332){
if(grep("specdata", directory) == T){
directory <- ("./specdata/")
}
tm <- c()
all_files <- as.character(list.files(directory))
file_paths <- paste(directory, all_files, sep="")
for (i in id){
current_file <- read.csv(file_paths[i], header=T, sep=",")
head(current_file)
pollutant
na_removed <- current_file[!is.na (current_file[, pollutant]), pollutant]
tm <- c(tm, na_removed)
}
result <- mean(tm)
return(round(result,3))
}
pollutantmean("specdata", "sulfate", 1:10)
pollutantmean("specdata", "nitrate", 70:72)
pollutantmean("specdata", "nitrate", 23)
complete <- function(directory, id=1:332){
if(grep("specdata", directory) == T){
directory <- ("./specdata/")
}
id_len <- length(id)
complete_data <- rep(0, id_len)
all_files <- as.character(list.files(directory))
file_paths <- paste(directory, all_files, sep="")
j <- 1
for (i in id){
current_file <- read.csv(file_paths[i], header=T, sep=",")
complete_data[j] <- sum(complete.cases(current_file))
j <- j + 1
}
result <- data.frame (id=id, nobs = complete_data)
return(result)}
complete("specdata", 1)
complete("specdata", c(2,4,8,10,12))
complete("specdata", 30:25)
complete("specdata", 3)
corr <- function(directory, threshold = 0){
if (grep("specdata", directory) == 1) {
directory <- ("./specdata/")
}
complete_table <- complete("specdata", 1:332)
nobs <- complete_table$nobs
ids <- complete_table$id[nobs > threshold]
id_len <- length(ids)
corr_vector <- rep(0, id_len)
all_files <- as.character(list.files(directory))
file_paths <- paste(directory, all_files, sep="")
j <- 1
for (i in ids){
current_file <- read.csv (file_paths[i], header=T, sep=",")
corr_vector [j] <- cor(current_file$sulfate, current_file$nitrate, use="complete.obs")
j <- j + 1
}
result <- corr_vector
return(result)
}
cr <- corr("specdata", 150)
head(cr)
summary(cr)
cr <- corr("specdata", 400)
head(cr)
summary(cr)
setwd("C://Work/Coursera/Week1 HW")
source("http://d396qusza40orc.cloudfront.net/rprog%2Fscripts%2Fsubmitscript1.R")
submit()
submit()
submit()
submit()
source("http://d396qusza40orc.cloudfront.net/rprog%2Fscripts%2Fsubmitscript1.R")
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
library(data.table)
filenames <- list.files(paths = "D://07 Research/TCGA/Thyroid carcinoma/RNASeqV2/Normalized Results")
filenames <- list.files("D://07 Research/TCGA/Thyroid carcinoma/RNASeqV2/Normalized Results")
filenames
